<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tidying data sets &#8212; Genome Analysis Workshop 0.2 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.6/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="Genome Analysis Workshop 0.2 documentation" href="../index.html" /> 

<!-- Google Analytics tracking code -->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54095998-2', 'auto');
  ga('send', 'pageview');

</script>


  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          Genome Analysis Workshop</a>
        <span class="navbar-text navbar-version pull-left"><b>0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Genome Analysis Workshop <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../Syllabus.html">Syllabus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Classes.html">Class list</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Exercises.html">Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Problem_Sets.html">Problem Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Miscellaneous.html">Miscellaneous</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Tidying data sets</a></li>
<li><a class="reference internal" href="#common-problems-with-messy-data">Common problems with messy data</a></li>
<li><a class="reference internal" href="#but-plotting-them-tells-another-story">... but plotting them tells another story ...</a></li>
<li><a class="reference internal" href="#tidying-the-anscombe-data-set">Tidying the <code class="docutils literal"><span class="pre">anscombe</span></code> data set</a></li>
<li><a class="reference internal" href="#id1">Tidying the <code class="docutils literal"><span class="pre">anscombe</span></code> data set</a></li>
<li><a class="reference internal" href="#adding-surrogate-observation-counts">Adding surrogate observation counts</a></li>
<li><a class="reference internal" href="#using-tidyr-gather">Using <code class="docutils literal"><span class="pre">tidyr::gather()</span></code></a></li>
<li><a class="reference internal" href="#using-tidyr-separate">Using <code class="docutils literal"><span class="pre">tidyr::separate()</span></code></a></li>
<li><a class="reference internal" href="#using-tidyr-spread">Using <code class="docutils literal"><span class="pre">tidyr::spread()</span></code></a></li>
<li><a class="reference internal" href="#other-tidyr-verbs">Other <code class="docutils literal"><span class="pre">tidyr</span></code> verbs</a></li>
<li><a class="reference internal" href="#tidyr-complete-the-full-set"><code class="docutils literal"><span class="pre">tidyr::complete()</span></code> the full set</a></li>
<li><a class="reference internal" href="#tidyr-complete-sets-of-variables-in-the-given-data"><code class="docutils literal"><span class="pre">tidyr::complete()</span></code> sets of variables in the given data</a></li>
<li><a class="reference internal" href="#tidying-practice">Tidying practice</a></li>
<li><a class="reference internal" href="#tidying-resources">Tidying resources</a></li>
</ul>

        </div>
      </div>
    <div class="col-md-9 content">
      
  <div class="section" id="tidying-data-sets">
<h1>Tidying data sets<a class="headerlink" href="#tidying-data-sets" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#tidying-data-sets" title="Slides">§</a></h1>
<p>Raw data must often be restructured to enable downstream analysis. A
useful format to start with is &#8220;tidy&#8221; data.</p>
<p>Tidy data has a few key principles:</p>
<ul class="simple">
<li>Each variable forms a column</li>
<li>Each observation forms a row</li>
<li>Each type of observational unit forms a table</li>
</ul>
</div>
<div class="section" id="common-problems-with-messy-data">
<h1>Common problems with messy data<a class="headerlink" href="#common-problems-with-messy-data" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#common-problems-with-messy-data" title="Slides">§</a></h1>
<ul class="simple">
<li>Column headers are values, not variable names.</li>
<li>Multiple variables are stored in one column.</li>
<li>Variables are stored in both rows and columns.</li>
</ul>
<p>```{r anscombe, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyr) library(dplyr) library(ggplot2)</p>
<p>anscombe_tidy_hide &lt;- anscombe %&gt;% tbl_df %&gt;% mutate(obs =
seq_len(n())) %&gt;% gather(key, value, -obs) %&gt;% separate(key,
c(&#8216;var&#8217;,&#8217;set&#8217;), 1) %&gt;% spread(var, value) %&gt;% arrange(set)
``<code class="docutils literal"><span class="pre">##</span> <span class="pre">The</span></code>anscombe` data sets</p>
<p>The <code class="docutils literal"><span class="pre">anscombe</span></code> data sets illustrate a key point of data analysis:
<strong>visualize your data</strong>.</p>
<p>Why? Standard statistics do not differentiate among the data sets:</p>
<p><code class="docutils literal"><span class="pre">{r</span> <span class="pre">anscombe_stats,</span> <span class="pre">echo</span> <span class="pre">=</span> <span class="pre">FALSE,</span> <span class="pre">message</span> <span class="pre">=</span> <span class="pre">FALSE}</span> <span class="pre">anscombe_tidy_hide</span> <span class="pre">%&gt;%</span>&#160;&#160; <span class="pre">group_by(set)</span> <span class="pre">%&gt;%</span>&#160;&#160; <span class="pre">summarize(len.data</span> <span class="pre">=</span> <span class="pre">n(),</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">mean.x</span> <span class="pre">=</span> <span class="pre">round(mean(x),</span> <span class="pre">digits</span> <span class="pre">=</span> <span class="pre">2),</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">mean.y</span> <span class="pre">=</span> <span class="pre">round(mean(y),</span> <span class="pre">digits</span> <span class="pre">=</span> <span class="pre">2),</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">variance.x</span> <span class="pre">=</span> <span class="pre">round(var(x),</span> <span class="pre">digits</span> <span class="pre">=</span> <span class="pre">2),</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">variance.y</span> <span class="pre">=</span> <span class="pre">round(var(y),</span> <span class="pre">digits</span> <span class="pre">=</span> <span class="pre">2),</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">set.correlation</span> <span class="pre">=</span> <span class="pre">round(cor(x,y),</span> <span class="pre">digits</span> <span class="pre">=</span> <span class="pre">2))</span></code></p>
</div>
<div class="section" id="but-plotting-them-tells-another-story">
<h1>... but plotting them tells another story ...<a class="headerlink" href="#but-plotting-them-tells-another-story" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#but-plotting-them-tells-another-story" title="Slides">§</a></h1>
<p><code class="docutils literal"><span class="pre">{r</span> <span class="pre">anscombe_plots,</span> <span class="pre">echo=FALSE,</span> <span class="pre">warning=FALSE}</span> <span class="pre">anscombe_tidy_hide</span> <span class="pre">%&gt;%</span>&#160;&#160; <span class="pre">ggplot(aes(x,y))</span> <span class="pre">+</span>&#160;&#160;&#160;&#160; <span class="pre">geom_point()</span> <span class="pre">+</span>&#160;&#160;&#160;&#160; <span class="pre">facet_wrap(~set)</span> <span class="pre">+</span>&#160;&#160;&#160;&#160; <span class="pre">geom_smooth(method='lm',</span> <span class="pre">se=FALSE)</span> <span class="pre">+</span>&#160;&#160;&#160;&#160; <span class="pre">theme_bw()</span></code></p>
</div>
<div class="section" id="tidying-the-anscombe-data-set">
<h1>Tidying the <code class="docutils literal"><span class="pre">anscombe</span></code> data set<a class="headerlink" href="#tidying-the-anscombe-data-set" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#tidying-the-anscombe-data-set" title="Slides">§</a></h1>
<p>The provided <code class="docutils literal"><span class="pre">anscombe</span></code> data set is <em>messy</em> because the set number and
x/y variables are combined in column names.</p>
<p><code class="docutils literal"><span class="pre">{r</span> <span class="pre">echo=FALSE}</span> <span class="pre">anscombe</span> <span class="pre">%&gt;%</span> <span class="pre">tbl_df</span></code></p>
</div>
<div class="section" id="id1">
<h1>Tidying the <code class="docutils literal"><span class="pre">anscombe</span></code> data set<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#id1" title="Slides">§</a></h1>
<p>We need to reformat the table into this form:</p>
<p><code class="docutils literal"><span class="pre">{r</span> <span class="pre">echo=FALSE}</span> <span class="pre">anscombe_tidy_hide</span> <span class="pre">%&gt;%</span> <span class="pre">tbl_df</span></code></p>
</div>
<div class="section" id="adding-surrogate-observation-counts">
<h1>Adding surrogate observation counts<a class="headerlink" href="#adding-surrogate-observation-counts" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#adding-surrogate-observation-counts" title="Slides">§</a></h1>
<p>We need to make sure that individual observations in the tidied data set
are identiable by a unique value. I call this the <code class="docutils literal"><span class="pre">observation</span> <span class="pre">id</span></code> or
<code class="docutils literal"><span class="pre">obs</span></code>.</p>
<p>```{r anscombe_mutate} anscombe_tidy &lt;- anscombe %&gt;% tbl_df %&gt;%
mutate(obs = seq_len(n()))</p>
<p>anscombe_tidy ```</p>
</div>
<div class="section" id="using-tidyr-gather">
<h1>Using <code class="docutils literal"><span class="pre">tidyr::gather()</span></code><a class="headerlink" href="#using-tidyr-gather" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#using-tidyr-gather" title="Slides">§</a></h1>
<p>```{r anscombe_gather} anscombe_tidy &lt;- anscombe_tidy %&gt;%
tidyr::gather(key, value, -obs)</p>
<p>anscombe_tidy ```</p>
<p>Think about the transformation that just happened.</p>
</div>
<div class="section" id="using-tidyr-separate">
<h1>Using <code class="docutils literal"><span class="pre">tidyr::separate()</span></code><a class="headerlink" href="#using-tidyr-separate" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#using-tidyr-separate" title="Slides">§</a></h1>
<p>```{r anscombe_separate} anscombe_tidy &lt;- anscombe_tidy %&gt;%
tidyr::separate(key, into = c(&#8216;var&#8217;, &#8216;set&#8217;), sep = 1)</p>
<p>anscombe_tidy ```</p>
<p>Think about the transformation that just happened.</p>
</div>
<div class="section" id="using-tidyr-spread">
<h1>Using <code class="docutils literal"><span class="pre">tidyr::spread()</span></code><a class="headerlink" href="#using-tidyr-spread" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#using-tidyr-spread" title="Slides">§</a></h1>
<p>We&#8217;re almost there. Now we need to <code class="docutils literal"><span class="pre">spread()</span></code> the <code class="docutils literal"><span class="pre">var</span></code> and
<code class="docutils literal"><span class="pre">value</span></code> columns.</p>
<p>```{r anscombe_spread, warning = FALSE} anscombe_tidy &lt;-
anscombe_tidy %&gt;% tidyr::spread(var, value)</p>
<p>anscombe_tidy ```</p>
</div>
<div class="section" id="other-tidyr-verbs">
<h1>Other <code class="docutils literal"><span class="pre">tidyr</span></code> verbs<a class="headerlink" href="#other-tidyr-verbs" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#other-tidyr-verbs" title="Slides">§</a></h1>
<p>Sometimes you have incomplete sets of observations in a data set. The
<code class="docutils literal"><span class="pre">complete()</span></code> verb addresses this issue by filling in missing values.</p>
<p><code class="docutils literal"><span class="pre">{r</span> <span class="pre">missing}</span> <span class="pre">df</span> <span class="pre">&lt;-</span> <span class="pre">dplyr::tibble(</span>&#160;&#160; <span class="pre">~group,</span> <span class="pre">~item_id,</span> <span class="pre">~item_name,</span> <span class="pre">~value1,</span> <span class="pre">~value2,</span>&#160;&#160; <span class="pre">1,</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">1,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">'a',</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">1,</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">4,</span>&#160;&#160; <span class="pre">2,</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">2,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">'b',</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2,</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">5,</span>&#160;&#160; <span class="pre">1,</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">2,</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">'b',</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">3,</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">6)</span></code></p>
</div>
<div class="section" id="tidyr-complete-the-full-set">
<h1><code class="docutils literal"><span class="pre">tidyr::complete()</span></code> the full set<a class="headerlink" href="#tidyr-complete-the-full-set" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#tidyr-complete-the-full-set" title="Slides">§</a></h1>
<p><code class="docutils literal"><span class="pre">{r</span> <span class="pre">missing_cont,</span> <span class="pre">eval=FALSE}</span> <span class="pre">#.</span> <span class="pre">1.</span> <span class="pre">expand</span> <span class="pre">*all*</span> <span class="pre">cominbations</span> <span class="pre">df</span> <span class="pre">%&gt;%</span> <span class="pre">tidyr::complete(group,</span> <span class="pre">item_id,</span> <span class="pre">item_name)</span></code></p>
</div>
<div class="section" id="tidyr-complete-sets-of-variables-in-the-given-data">
<h1><code class="docutils literal"><span class="pre">tidyr::complete()</span></code> sets of variables in the given data<a class="headerlink" href="#tidyr-complete-sets-of-variables-in-the-given-data" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#tidyr-complete-sets-of-variables-in-the-given-data" title="Slides">§</a></h1>
<p><code class="docutils literal"><span class="pre">{r</span> <span class="pre">missing_cont_2,</span> <span class="pre">eval=FALSE}</span> <span class="pre">#.</span> <span class="pre">2.</span> <span class="pre">only</span> <span class="pre">expand</span> <span class="pre">sets</span> <span class="pre">that</span> <span class="pre">are</span> <span class="pre">observed</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">given</span> <span class="pre">data</span> <span class="pre">df</span> <span class="pre">%&gt;%</span> <span class="pre">tidyr::complete(group,</span> <span class="pre">c(item_id,</span> <span class="pre">item_name))</span></code></p>
</div>
<div class="section" id="tidying-practice">
<h1>Tidying practice<a class="headerlink" href="#tidying-practice" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#tidying-practice" title="Slides">§</a></h1>
<ul class="simple">
<li>What happens if you retidy the <code class="docutils literal"><span class="pre">anscombe</span></code> set, but you leave out
the <code class="docutils literal"><span class="pre">obs</span></code> column?</li>
<li>Practice tidying other R builtin data sets. Use
<code class="docutils literal"><span class="pre">library(help</span> <span class="pre">=</span> <span class="pre">&quot;datasets&quot;)</span></code> to see all of the builtin datasets.
Try the <code class="docutils literal"><span class="pre">ability.cov</span></code> dataset, and try combining the <code class="docutils literal"><span class="pre">beaver1</span></code>
and <code class="docutils literal"><span class="pre">beaver2</span></code> data sets.</li>
</ul>
</div>
<div class="section" id="tidying-resources">
<h1>Tidying resources<a class="headerlink" href="#tidying-resources" title="Permalink to this headline">¶</a><a class="headerlink" href="../slides/workshop-rstudio/tidy_data.html#tidying-resources" title="Slides">§</a></h1>
<ul class="simple">
<li>Paper on <a class="reference external" href="http://vita.had.co.nz/papers/tidy-data.pdf">Tidy Data</a></li>
<li>Blog on <a class="reference external" href="http://simplystatistics.org/2016/02/17/non-tidy-data/">&#8220;non-Tidy
Data&#8221;</a></li>
</ul>
</div>


    </div>
      
  </div>
</div>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>

  </body>
</html>